# Word 转 Markdown 工具

## 功能说明

`docx_to_md.py` 是一个功能强大的 Word 文档转 Markdown 工具，专门针对中文文档进行了优化。

### 核心功能

1. **完整格式保留**
   - 保留文档顺序（段落、表格、列表、标题）
   - 支持有序列表和无序列表
   - 保留表格格式
   - 保留文本样式（粗体、斜体）
   - 支持目录样式转换

2. **图片处理**
   - 自动导出文档中的图片到 `Images/<文档名>_images/` 目录
   - 在 Markdown 中自动生成正确的相对路径引用
   - 避免图片文件名冲突

3. **中文格式优化**
   - **修复粗体引号格式问题**：自动将引号从粗体标记内移到外部
     - `**"文本"**` → `**"文本"**`
     - `"**文本**"` → `**"文本"**`
   - 统一标点符号编码为标准中文标点
   - 合并相邻的粗体块，减少冗余标记
   - 将标点符号移到粗体标记外部

4. **智能处理**
   - 检测并格式化列表项（包括手动换行形成的列表）
   - 处理手动换行符和软换行
   - 自动添加 Markdown 软换行标记（行尾两空格）
   - 修复常见的格式问题

## 使用方法

### 基本用法

```bash
python docx_to_md.py <Word文档路径>
```

### 规范化文件名

使用 `--normalize` 选项可以自动规范化文件名（移除特殊字符，用连字符替换空格）：

```bash
python docx_to_md.py <Word文档路径> --normalize
```

### 示例

```bash
# 转换单个文档
python docx_to_md.py "我的文档.docx"

# 转换并规范化文件名
python docx_to_md.py "我的文档.docx" --normalize
```

## 输出结果

- 生成的 Markdown 文件保存在与 Word 文档相同的目录下
- 图片保存在 `Images/<文档名>_images/` 目录中
- 所有图片引用使用相对路径

## 格式修复示例

### 粗体引号修复

转换前（Word 导出的问题格式）：
```markdown
如果不了解自己大脑的这套**"默认操作系统"**，所有的自我提升方法都如同在Windows系统上安装Mac软件，无法真正运行。
真正的改变始于**"认知的认知"** ——以旁观者视角观察自己的思维模式。
```

转换后（正确格式）：
```markdown
如果不了解自己大脑的这套**"默认操作系统"**，所有的自我提升方法都如同在Windows系统上安装Mac软件，无法真正运行。  
真正的改变始于**"认知的认知"** ——以旁观者视角观察自己的思维模式。  
```

### 标点符号规范化

- 英文引号 `"` 自动转换为中文引号 `"` 和 `"`
- 英文标点在中文上下文中自动转换为中文标点
- 保持代码块和英文文本中的原有标点

## 依赖项

```bash
pip install python-docx
```

## 技术特点

- **幂等性**：对同一文档重复运行产生相同的输出
- **智能合并**：自动合并相同样式的连续文本块
- **格式清理**：自动修复常见的格式问题
- **中文优化**：专门针对中文文档的排版规则优化

## 注意事项

1. 确保安装了 `python-docx` 库
2. Word 文档应使用标准的样式（标题、列表等）
3. 生成的 Markdown 文件编码为 UTF-8
4. 图片目录会自动创建，无需手动创建
